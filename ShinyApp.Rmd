---
title: "ShinyApp"
author: "141B Group"
date: "3/18/2020"
output: html_document
---
```{r}
library(shiny)
library(dplyr)
library(tidyverse)
```
```{r}
ui <- fluidPage(
  #create a layout
  sidebarLayout(
    #sidebar area
  sidebarPanel(
    #user select their interested from the drop down menu
    selectInput(inputId = "question",#take user's input as variable question
              label = "Select your instered question: ",
              choices = unique(questions), #options in the dropdown menu
              selected = NULL)),#default selection
  #user select their interested category from the drop down menu
  selectInput(inputId = "catergory",
              label = "Select your interested catergory: ",
              choices = unique(),
              selected = NULL),
  #main area
  mainPanel(
    tabsetPanel(#the distribution tab
      tabPanel("Distribution", plotOutput("selected_graph")),#the tab shows the graph
    #position of sidebar
    position = c("left"),
    #fixed
    fluid = FALSE))))

server <- function(input, output){
  #filter out the needed data
  data_frame_name2 <- reactive({
    filter(data_frame_name, question==input$question & category==input$category)})
  
  #output of ggplot
  output$selected_graph <- renderPlot({
    ggplot(data=data_frame_name,aes(x=week,y=percent, group = response))+
      geom_point()+geom_line(aes(color=response))
      ggtitle(paste("Proportional Changes in Answer Based on ",input$category,"of",input$destination))})}
  
shinyApp(ui = ui, server = server)

```
